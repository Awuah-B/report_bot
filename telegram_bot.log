2025-07-25 16:38:45,021 - utils - ERROR - Failed to connect to database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:45,023 - utils - INFO - main.py functionalities executed successfully during bot initialization
2025-07-25 16:38:45,023 - utils - INFO - NPAMonitorBot initialized successfully
2025-07-25 16:38:45,024 - utils - INFO - Background monitoring started
2025-07-25 16:38:45,024 - utils - INFO - Starting NPA Monitor Bot with webhook...
2025-07-25 16:38:45,024 - utils - INFO - Started monitoring loop
2025-07-25 16:38:45,024 - utils - INFO - main.py functionalities executed successfully
2025-07-25 16:38:49,368 - utils - INFO - Fetched 2729 records from API
2025-07-25 16:38:49,502 - utils - INFO - Processed 162 records
2025-07-25 16:38:49,567 - utils - INFO - Split data into 10 sections
2025-07-25 16:38:50,933 - utils - ERROR - Failed to backup data for Approved: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:52,189 - utils - ERROR - Failed to clear data from Approved: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:53,418 - utils - ERROR - Failed to insert data into Approved: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:54,605 - utils - ERROR - Failed to backup data for BDC_Cancel_Order: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:55,875 - utils - ERROR - Failed to clear data from BDC_Cancel_Order: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:57,104 - utils - ERROR - Failed to insert data into BDC_Cancel_Order: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:58,299 - utils - ERROR - Failed to backup data for BDC_Decline: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:59,561 - utils - ERROR - Failed to clear data from BDC_Decline: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:39:00,790 - utils - ERROR - Failed to insert data into BDC_Decline: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:39:02,032 - utils - ERROR - Failed to backup data for BRV_Checked: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:39:03,248 - utils - ERROR - Failed to clear data from BRV_Checked: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:39:04,477 - utils - ERROR - Failed to insert data into BRV_Checked: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:39:05,871 - utils - ERROR - Failed to get existing hashes for Depot_Manager: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:39:07,139 - utils - ERROR - Failed to save new records for Depot_Manager: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:39:08,369 - utils - INFO - Database engine disposed
2025-07-25 16:39:08,369 - utils - INFO - Background monitoring stopped
2025-07-25 16:39:08,897 - utils - ERROR - Fatal error: This Updater is not running!
2025-07-26 07:37:12,635 - utils - INFO - Table initialization check completed
2025-07-26 07:37:12,638 - utils - INFO - main.py functionalities executed successfully during bot initialization
2025-07-26 07:37:12,638 - utils - INFO - NPAMonitorBot initialized successfully with Supabase
2025-07-26 07:37:13,198 - utils - INFO - Supabase connection test successful
2025-07-26 07:37:13,198 - utils - INFO - Supabase connection verified successfully
2025-07-26 07:37:13,198 - utils - INFO - Background monitoring started with Supabase backend
2025-07-26 07:37:13,198 - utils - INFO - Starting NPA Monitor Bot with webhook and Supabase backend...
2025-07-26 07:37:13,199 - utils - INFO - Started monitoring loop with Supabase backend
2025-07-26 07:37:13,199 - utils - INFO - Starting monitoring check #1
2025-07-26 07:37:13,199 - utils - INFO - main.py functionalities executed successfully
2025-07-26 07:37:13,199 - utils - INFO - Starting new records check with Supabase...
2025-07-26 07:37:13,200 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 07:37:14,818 - utils - INFO - Successfully fetched 112 rows from API
2025-07-26 07:37:14,819 - utils - INFO - Fetched 112 records from API
2025-07-26 07:37:14,819 - utils - INFO - Processing DataFrame with 112 rows and 21 columns
2025-07-26 07:37:14,837 - utils - INFO - Found 5 BOST-KUMASI records
2025-07-26 07:37:14,846 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 07:37:14,864 - utils - INFO - Successfully converted data types
2025-07-26 07:37:14,879 - utils - INFO - Final processed DataFrame: 4 rows
2025-07-26 07:37:14,880 - utils - INFO - Processed 4 records
2025-07-26 07:37:14,896 - utils - INFO - Split data into 0 sections
2025-07-26 07:37:15,497 - utils - INFO - Supabase connection test successful
2025-07-26 07:37:15,498 - utils - INFO - No data found for table approved
2025-07-26 07:37:15,498 - utils - INFO - No data found for table bdc_cancel_order
2025-07-26 07:37:15,498 - utils - INFO - No data found for table bdc_decline
2025-07-26 07:37:15,498 - utils - INFO - No data found for table brv_checked
2025-07-26 07:37:15,498 - utils - INFO - No data found for table depot_manager
2025-07-26 07:37:15,498 - utils - INFO - No data found for table good_standing
2025-07-26 07:37:15,499 - utils - INFO - No data found for table loaded
2025-07-26 07:37:15,499 - utils - INFO - No data found for table order_released
2025-07-26 07:37:15,499 - utils - INFO - No data found for table ordered
2025-07-26 07:37:15,499 - utils - INFO - No data found for table ppmc_cancel_order
2025-07-26 07:37:15,499 - utils - INFO - No data found for table depot_manager_decline
2025-07-26 07:37:15,499 - utils - INFO - No data found for table marked
2025-07-26 07:37:15,499 - utils - INFO - Successfully populated tables: ['approved', 'bdc_cancel_order', 'bdc_decline', 'brv_checked', 'depot_manager', 'good_standing', 'loaded', 'order_released', 'ordered', 'ppmc_cancel_order', 'depot_manager_decline', 'marked']
2025-07-26 07:37:16,080 - utils - INFO - No new records found
2025-07-26 07:37:16,080 - utils - INFO - Monitoring check completed: 0 new records
2025-07-26 07:37:26,640 - utils - INFO - Webhook set to https://report-bot-01yl.onrender.com/8396776544:AAHIsDD4tfuDMobPGhVzwEPtjWzWaRRmGtQ
2025-07-26 07:37:27,362 - utils - INFO - Bot is running with Supabase backend.
2025-07-26 07:37:29,611 - utils - INFO - Notified superadmin 987905940 with message: 🚀 NPA Monitor Bot started successfully with Supabase backend!
2025-07-26 07:38:33,075 - utils - INFO - Background monitoring stopped
2025-07-26 07:38:34,060 - utils - INFO - Bot shutdown complete
2025-07-26 08:16:41,504 - utils - INFO - Table initialization check completed
2025-07-26 08:16:41,506 - utils - INFO - main.py functionalities executed successfully during bot initialization
2025-07-26 08:16:41,506 - utils - INFO - NPAMonitorBot initialized successfully with Supabase
2025-07-26 08:16:42,106 - utils - INFO - Supabase connection test successful
2025-07-26 08:16:42,107 - utils - INFO - Supabase connection verified successfully
2025-07-26 08:16:42,107 - utils - INFO - Background monitoring started with Supabase backend
2025-07-26 08:16:42,107 - utils - INFO - Starting NPA Monitor Bot with webhook and Supabase backend...
2025-07-26 08:16:42,107 - utils - INFO - Started monitoring loop with Supabase backend
2025-07-26 08:16:42,108 - utils - INFO - Starting monitoring check #1
2025-07-26 08:16:42,108 - utils - INFO - main.py functionalities executed successfully
2025-07-26 08:16:42,108 - utils - INFO - Starting new records check with Supabase...
2025-07-26 08:16:42,108 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 08:16:45,836 - utils - INFO - Successfully fetched 116 rows from API
2025-07-26 08:16:45,837 - utils - INFO - Fetched 116 records from API
2025-07-26 08:16:45,837 - utils - INFO - Processing DataFrame with 116 rows and 21 columns
2025-07-26 08:16:45,867 - utils - INFO - Found 6 BOST-KUMASI records
2025-07-26 08:16:45,889 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 08:16:45,933 - utils - INFO - Successfully converted data types
2025-07-26 08:16:45,935 - utils - INFO - Final processed DataFrame: 5 rows
2025-07-26 08:16:45,935 - utils - INFO - Processed 5 records
2025-07-26 08:16:45,944 - utils - INFO - Split data into 0 sections
2025-07-26 08:16:46,480 - utils - INFO - Supabase connection test successful
2025-07-26 08:16:46,480 - utils - INFO - No data found for table approved
2025-07-26 08:16:46,480 - utils - INFO - No data found for table bdc_cancel_order
2025-07-26 08:16:46,480 - utils - INFO - No data found for table bdc_decline
2025-07-26 08:16:46,480 - utils - INFO - No data found for table brv_checked
2025-07-26 08:16:46,480 - utils - INFO - No data found for table depot_manager
2025-07-26 08:16:46,481 - utils - INFO - No data found for table good_standing
2025-07-26 08:16:46,481 - utils - INFO - No data found for table loaded
2025-07-26 08:16:46,481 - utils - INFO - No data found for table order_released
2025-07-26 08:16:46,481 - utils - INFO - No data found for table ordered
2025-07-26 08:16:46,481 - utils - INFO - No data found for table ppmc_cancel_order
2025-07-26 08:16:46,481 - utils - INFO - No data found for table depot_manager_decline
2025-07-26 08:16:46,481 - utils - INFO - No data found for table marked
2025-07-26 08:16:46,481 - utils - INFO - Successfully populated tables: ['approved', 'bdc_cancel_order', 'bdc_decline', 'brv_checked', 'depot_manager', 'good_standing', 'loaded', 'order_released', 'ordered', 'ppmc_cancel_order', 'depot_manager_decline', 'marked']
2025-07-26 08:16:47,018 - utils - INFO - No new records found
2025-07-26 08:16:47,019 - utils - INFO - Monitoring check completed: 0 new records
2025-07-26 08:16:48,517 - utils - INFO - Webhook set to https://report-bot-cs7g.onrender.com/8396776544:AAHIsDD4tfuDMobPGhVzwEPtjWzWaRRmGtQ
2025-07-26 08:16:50,977 - utils - INFO - Bot is running with Supabase backend.
2025-07-26 08:16:52,073 - utils - INFO - Notified superadmin 987905940 with message: 🚀 NPA Monitor Bot started successfully with Supabase backend!
2025-07-26 08:21:47,022 - utils - INFO - Starting monitoring check #2
2025-07-26 08:21:47,024 - utils - INFO - main.py functionalities executed successfully
2025-07-26 08:21:47,024 - utils - INFO - Starting new records check with Supabase...
2025-07-26 08:21:47,024 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 08:21:48,787 - utils - INFO - Successfully fetched 118 rows from API
2025-07-26 08:21:48,787 - utils - INFO - Fetched 118 records from API
2025-07-26 08:21:48,788 - utils - INFO - Processing DataFrame with 118 rows and 21 columns
2025-07-26 08:21:48,804 - utils - INFO - Found 6 BOST-KUMASI records
2025-07-26 08:21:48,811 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 08:21:48,816 - utils - INFO - Successfully converted data types
2025-07-26 08:21:48,817 - utils - INFO - Final processed DataFrame: 5 rows
2025-07-26 08:21:48,818 - utils - INFO - Processed 5 records
2025-07-26 08:21:48,836 - utils - INFO - Split data into 0 sections
2025-07-26 08:21:50,091 - utils - INFO - Supabase connection test successful
2025-07-26 08:21:50,091 - utils - INFO - No data found for table approved
2025-07-26 08:21:50,092 - utils - INFO - No data found for table bdc_cancel_order
2025-07-26 08:21:50,092 - utils - INFO - No data found for table bdc_decline
2025-07-26 08:21:50,092 - utils - INFO - No data found for table brv_checked
2025-07-26 08:21:50,092 - utils - INFO - No data found for table depot_manager
2025-07-26 08:21:50,092 - utils - INFO - No data found for table good_standing
2025-07-26 08:21:50,092 - utils - INFO - No data found for table loaded
2025-07-26 08:21:50,093 - utils - INFO - No data found for table order_released
2025-07-26 08:21:50,093 - utils - INFO - No data found for table ordered
2025-07-26 08:21:50,093 - utils - INFO - No data found for table ppmc_cancel_order
2025-07-26 08:21:50,093 - utils - INFO - No data found for table depot_manager_decline
2025-07-26 08:21:50,093 - utils - INFO - No data found for table marked
2025-07-26 08:21:50,093 - utils - INFO - Successfully populated tables: ['approved', 'bdc_cancel_order', 'bdc_decline', 'brv_checked', 'depot_manager', 'good_standing', 'loaded', 'order_released', 'ordered', 'ppmc_cancel_order', 'depot_manager_decline', 'marked']
2025-07-26 08:21:50,545 - utils - INFO - No new records found
2025-07-26 08:21:50,545 - utils - INFO - Monitoring check completed: 0 new records
2025-07-26 08:23:25,574 - utils - INFO - Background monitoring stopped
2025-07-26 08:23:26,480 - utils - INFO - Bot shutdown complete
