2025-07-25 16:38:06,751 - utils - INFO - Data fetched successfully
2025-07-25 16:38:06,957 - utils - INFO - Data processed successfully
2025-07-25 16:38:08,363 - utils - ERROR - Failed to connect to database: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:10,207 - utils - ERROR - Failed to backup data for Approved: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:11,435 - utils - ERROR - Failed to clear data from Approved: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:12,664 - utils - ERROR - Failed to insert data into Approved: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:13,893 - utils - ERROR - Failed to backup data for BDC_Cancel_Order: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:15,093 - utils - ERROR - Failed to clear data from BDC_Cancel_Order: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:16,350 - utils - ERROR - Failed to insert data into BDC_Cancel_Order: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:17,784 - utils - ERROR - Failed to backup data for BDC_Decline: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:19,013 - utils - ERROR - Failed to clear data from BDC_Decline: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:20,367 - utils - ERROR - Failed to insert data into BDC_Decline: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:21,675 - utils - ERROR - Failed to backup data for BRV_Checked: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:22,903 - utils - ERROR - Failed to clear data from BRV_Checked: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:24,337 - utils - ERROR - Failed to insert data into BRV_Checked: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-25 16:38:25,566 - utils - ERROR - Failed to get existing hashes for Depot_Manager: (psycopg2.OperationalError) connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found
connection to server at "aws-0-eu-north-1.pooler.supabase.com" (16.16.102.12), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-26 07:30:10,580 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 07:31:11,449 - utils - ERROR - API request timed out
2025-07-26 07:31:43,038 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 07:32:08,146 - utils - INFO - Successfully fetched 112 rows from API
2025-07-26 07:32:08,147 - utils - INFO - Processing DataFrame with 112 rows and 21 columns
2025-07-26 07:32:08,206 - utils - INFO - Found 5 BOST-KUMASI records
2025-07-26 07:32:08,218 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 07:32:08,250 - utils - INFO - Successfully converted data types
2025-07-26 07:32:08,250 - utils - INFO - Final processed DataFrame: 4 rows
2025-07-26 07:32:25,717 - utils - INFO - Table initialization check completed
2025-07-26 07:32:37,239 - utils - INFO - Table initialization check completed
2025-07-26 07:32:38,117 - utils - INFO - === Starting NPA Data Processing with Supabase ===
2025-07-26 07:32:49,694 - utils - INFO - Table initialization check completed
2025-07-26 07:32:50,573 - utils - INFO - Supabase connection test successful
2025-07-26 07:32:50,573 - utils - INFO - Successfully connected to Supabase
2025-07-26 07:32:50,574 - utils - INFO - Fetching data from NPA API...
2025-07-26 07:32:50,574 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 07:32:53,132 - utils - INFO - Successfully fetched 112 rows from API
2025-07-26 07:32:53,132 - utils - INFO - Data fetched successfully: 112 rows
2025-07-26 07:32:53,133 - utils - INFO - Processing fetched data...
2025-07-26 07:32:53,133 - utils - INFO - Processing DataFrame with 112 rows and 21 columns
2025-07-26 07:32:53,145 - utils - INFO - Found 5 BOST-KUMASI records
2025-07-26 07:32:53,149 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 07:32:53,153 - utils - INFO - Successfully converted data types
2025-07-26 07:32:53,155 - utils - INFO - Final processed DataFrame: 4 rows
2025-07-26 07:32:53,155 - utils - INFO - Data processed successfully: 4 rows
2025-07-26 07:32:53,155 - utils - INFO - Splitting data into sections...
2025-07-26 07:32:53,167 - utils - INFO - Data split into 0 sections: []
2025-07-26 07:32:53,167 - utils - INFO - Populating Supabase tables...
2025-07-26 07:32:54,310 - utils - INFO - Supabase connection test successful
2025-07-26 07:32:54,310 - utils - INFO - No data found for table approved
2025-07-26 07:32:54,310 - utils - INFO - No data found for table bdc_cancel_order
2025-07-26 07:32:54,310 - utils - INFO - No data found for table bdc_decline
2025-07-26 07:32:54,310 - utils - INFO - No data found for table brv_checked
2025-07-26 07:32:54,310 - utils - INFO - No data found for table depot_manager
2025-07-26 07:32:54,310 - utils - INFO - No data found for table good_standing
2025-07-26 07:32:54,310 - utils - INFO - No data found for table loaded
2025-07-26 07:32:54,311 - utils - INFO - No data found for table order_released
2025-07-26 07:32:54,311 - utils - INFO - No data found for table ordered
2025-07-26 07:32:54,311 - utils - INFO - No data found for table ppmc_cancel_order
2025-07-26 07:32:54,311 - utils - INFO - No data found for table depot_manager_decline
2025-07-26 07:32:54,311 - utils - INFO - No data found for table marked
2025-07-26 07:32:54,312 - utils - INFO - All tables processed successfully: ['approved', 'bdc_cancel_order', 'bdc_decline', 'brv_checked', 'depot_manager', 'good_standing', 'loaded', 'order_released', 'ordered', 'ppmc_cancel_order', 'depot_manager_decline', 'marked']
2025-07-26 07:33:19,973 - utils - INFO - Table statistics: {'approved': 1, 'bdc_cancel_order': 1, 'bdc_decline': 1, 'brv_checked': 1, 'depot_manager': 1, 'good_standing': 1, 'loaded': 1, 'order_released': 1, 'ordered': 1, 'ppmc_cancel_order': 1, 'depot_manager_decline': 1, 'marked': 1}
2025-07-26 07:33:19,973 - utils - INFO - === NPA Data Processing completed successfully ===
2025-07-26 07:35:26,301 - utils - INFO - === Starting NPA Data Processing with Supabase ===
2025-07-26 07:35:38,870 - utils - INFO - Table initialization check completed
2025-07-26 07:35:40,509 - utils - INFO - Supabase connection test successful
2025-07-26 07:35:40,509 - utils - INFO - Successfully connected to Supabase
2025-07-26 07:35:40,510 - utils - INFO - Fetching data from NPA API...
2025-07-26 07:35:40,510 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 07:35:43,786 - utils - INFO - Successfully fetched 112 rows from API
2025-07-26 07:35:43,787 - utils - INFO - Data fetched successfully: 112 rows
2025-07-26 07:35:43,788 - utils - INFO - Processing fetched data...
2025-07-26 07:35:43,788 - utils - INFO - Processing DataFrame with 112 rows and 21 columns
2025-07-26 07:35:43,799 - utils - INFO - Found 5 BOST-KUMASI records
2025-07-26 07:35:43,806 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 07:35:43,814 - utils - INFO - Successfully converted data types
2025-07-26 07:35:43,817 - utils - INFO - Final processed DataFrame: 4 rows
2025-07-26 07:35:43,817 - utils - INFO - Data processed successfully: 4 rows
2025-07-26 07:35:43,818 - utils - INFO - Splitting data into sections...
2025-07-26 07:35:43,821 - utils - INFO - Data split into 0 sections: []
2025-07-26 07:35:43,821 - utils - INFO - Populating Supabase tables...
2025-07-26 07:35:44,806 - utils - INFO - Supabase connection test successful
2025-07-26 07:35:44,806 - utils - INFO - No data found for table approved
2025-07-26 07:35:44,806 - utils - INFO - No data found for table bdc_cancel_order
2025-07-26 07:35:44,806 - utils - INFO - No data found for table bdc_decline
2025-07-26 07:35:44,806 - utils - INFO - No data found for table brv_checked
2025-07-26 07:35:44,806 - utils - INFO - No data found for table depot_manager
2025-07-26 07:35:44,807 - utils - INFO - No data found for table good_standing
2025-07-26 07:35:44,807 - utils - INFO - No data found for table loaded
2025-07-26 07:35:44,807 - utils - INFO - No data found for table order_released
2025-07-26 07:35:44,807 - utils - INFO - No data found for table ordered
2025-07-26 07:35:44,807 - utils - INFO - No data found for table ppmc_cancel_order
2025-07-26 07:35:44,807 - utils - INFO - No data found for table depot_manager_decline
2025-07-26 07:35:44,807 - utils - INFO - No data found for table marked
2025-07-26 07:35:44,807 - utils - INFO - All tables processed successfully: ['approved', 'bdc_cancel_order', 'bdc_decline', 'brv_checked', 'depot_manager', 'good_standing', 'loaded', 'order_released', 'ordered', 'ppmc_cancel_order', 'depot_manager_decline', 'marked']
2025-07-26 07:36:02,643 - utils - INFO - Table statistics: {'approved': 1, 'bdc_cancel_order': 1, 'bdc_decline': 1, 'brv_checked': 1, 'depot_manager': 1, 'good_standing': 1, 'loaded': 1, 'order_released': 1, 'ordered': 1, 'ppmc_cancel_order': 1, 'depot_manager_decline': 1, 'marked': 1}
2025-07-26 07:36:02,643 - utils - INFO - === NPA Data Processing completed successfully ===
2025-07-26 11:33:43,154 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 11:33:46,239 - utils - INFO - Successfully fetched 146 rows from API
2025-07-26 11:33:46,240 - utils - INFO - Processing DataFrame with 146 rows and 21 columns
2025-07-26 11:33:46,256 - utils - INFO - Found 9 BOST-KUMASI records
2025-07-26 11:33:46,267 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 11:33:46,272 - utils - INFO - Successfully converted data types
2025-07-26 11:33:46,273 - utils - INFO - Final processed DataFrame: 7 rows
2025-07-26 11:33:59,566 - utils - INFO - Table initialization check completed
2025-07-26 11:34:10,123 - utils - INFO - Table initialization check completed
2025-07-26 11:34:10,778 - utils - INFO - === Starting NPA Data Processing with Supabase ===
2025-07-26 11:34:19,150 - utils - INFO - Table initialization check completed
2025-07-26 11:34:19,811 - utils - INFO - Supabase connection test successful
2025-07-26 11:34:19,811 - utils - INFO - Successfully connected to Supabase
2025-07-26 11:34:19,811 - utils - INFO - Fetching data from NPA API...
2025-07-26 11:34:19,812 - utils - INFO - Fetching data for date range: 25-07-2025 to 26-07-2025
2025-07-26 11:34:22,134 - utils - INFO - Successfully fetched 145 rows from API
2025-07-26 11:34:22,134 - utils - INFO - Data fetched successfully: 145 rows
2025-07-26 11:34:22,134 - utils - INFO - Processing fetched data...
2025-07-26 11:34:22,134 - utils - INFO - Processing DataFrame with 145 rows and 21 columns
2025-07-26 11:34:22,144 - utils - INFO - Found 8 BOST-KUMASI records
2025-07-26 11:34:22,148 - utils - INFO - Renamed columns: ['ORDER_DATE', 'ORDER_NUMBER', 'PRODUCTS', 'VOLUME', 'EX_REF_PRICE', 'BRV_NUMBER', 'BDC']
2025-07-26 11:34:22,151 - utils - INFO - Successfully converted data types
2025-07-26 11:34:22,152 - utils - INFO - Final processed DataFrame: 7 rows
2025-07-26 11:34:22,152 - utils - INFO - Data processed successfully: 7 rows
2025-07-26 11:34:22,152 - utils - INFO - Splitting data into sections...
2025-07-26 11:34:22,156 - utils - INFO - Data split into 0 sections: []
2025-07-26 11:34:22,156 - utils - INFO - Populating Supabase tables...
2025-07-26 11:34:22,756 - utils - INFO - Supabase connection test successful
2025-07-26 11:34:22,756 - utils - INFO - Table population completed. Successful: ['approved', 'bdc_cancel_order', 'bdc_decline', 'brv_checked', 'depot_manager', 'good_standing', 'loaded', 'order_released', 'ordered', 'ppmc_cancel_order', 'depot_manager_decline', 'marked']
2025-07-26 11:34:22,757 - utils - INFO - All tables processed successfully: ['approved', 'bdc_cancel_order', 'bdc_decline', 'brv_checked', 'depot_manager', 'good_standing', 'loaded', 'order_released', 'ordered', 'ppmc_cancel_order', 'depot_manager_decline', 'marked']
2025-07-26 11:34:47,318 - utils - INFO - Table statistics: {'approved': 1, 'bdc_cancel_order': 1, 'bdc_decline': 1, 'brv_checked': 1, 'depot_manager': 1, 'good_standing': 1, 'loaded': 1, 'order_released': 1, 'ordered': 1, 'ppmc_cancel_order': 1, 'depot_manager_decline': 1, 'marked': 1}
2025-07-26 11:34:47,319 - utils - INFO - === NPA Data Processing completed successfully ===
